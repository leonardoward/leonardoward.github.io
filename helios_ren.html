<!DOCTYPE html>
<html class="no-js" lang="en">
<head>

    <!--- basic page needs
    ================================================== -->
    <meta charset="utf-8">
    <title>HELIOS REN Tail Light System</title>
    <meta name="HELIOS REN Tail Light System" content="">
    <meta name="Leonardo Ward" content="">

    <!-- mobile specific metas
    ================================================== -->
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <!-- CSS
    ================================================== -->
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/vendor.css">
    <link rel="stylesheet" href="css/main.css">

    <!-- script
    ================================================== -->
    <script src="js/modernizr.js"></script>

    <!-- favicons
    ================================================== -->
    <link rel="shortcut icon" href="icons8-curly-brackets-48.png" type="image/x-icon">
    <link rel="icon" href="icons8-curly-brackets-48.png" type="image/x-icon">

</head>

<body id="top">

    <!-- preloader
    ================================================== -->
    <div id="preloader">
        <div id="loader" class="dots-fade">
            <div></div>
            <div></div>
            <div></div>
        </div>
    </div>


    <!-- header
    ================================================== -->
    <header class="s-header header">

        <!-- <div class="header__logo">
            <a class="logo" href="index.html">
                <img src="images/logo.svg" alt="Homepage">
            </a>
        </div>  -->
        <!-- end header__logo -->

        <a class="header__toggle-menu" href="#0" title="Menu"><span>Menu</span></a>
        <nav class="header__nav-wrap">

            <h2 class="header__nav-heading h6">Navigate to</h2>

            <ul class="header__nav">
                <li><a href="index.html" title="">Home</a></li>

                <li class="has-children">
                    <a href="embedded-hardware.html" title="">Embedded Hardware</a>
                    <ul class="sub-menu">
                        <li class="has-children"><a href="ejam.html">EJA M</a>
                          <ul class="sub-menu">
                            <li><a href="ejam.html" title="">Description</a></li>
                            <li><a href="ejam.html#planning" title="">Planning</a></li>
                            <li><a href="ejam.html#hardware-design" title="">Hardware Design</a></li>
                            <li><a href="ejam.html#usb-c-port-with-electromagnetic-compatibility-emc" title="">USB C Port with EMC</a></li>
                            <li><a href="ejam.html#ftdi-ft260s" title="">FTDI FT260S</a></li>
                            <li><a href="ejam.html#auto-reset-circuit-for-the-esp32" title="">Auto Reset Circuit</a></li>
                            <li><a href="ejam.html#esp32" title="">ESP32</a></li>
                            <li><a href="ejam.html#gps" title="">GPS</a></li>
                            <li><a href="ejam.html#lora" title="">LoRa</a></li>
                            <li><a href="ejam.html#real-time-clock-rtc" title="">Real time Clock RTC</a></li>
                            <li><a href="ejam.html#5v-2a-stepup" title="">5V 2A Stepup</a></li>
                            <li><a href="ejam.html#battery-charging-circuit" title="">Battery Charging</a></li>
                            <li><a href="ejam.html#3v3-3a-sepic-converter" title="">3V3 3A SEPIC Converter</a></li>
                            <li><a href="ejam.html#on-off-button-circuit" title="">ON-OFF Button Circuit</a></li>
                            <li><a href="ejam.html#pcb-dimensions-and-boundaries" title="">PCB Dimensions and Boundaries</a></li>
                            <li><a href="ejam.html#bill-of-materials" title="">Bill of Materials</a></li>
                            <li><a href="ejam.html#pcb" title="">PCB</a></li>
                          </ul>
                        </li>
                        <li class="has-children"><a href="ftdi-dev-board.html">FTDI Development Board</a>
                          <ul class="sub-menu">
                            <li><a href="ftdi-dev-board.html" title="">Description</a></li>
                            <li><a href="ftdi-dev-board.html#hardware-design" title="">Hardware Design</a></li>
                            <li><a href="ftdi-dev-board.html#usb-c-port-with-electromagnetic-compatibility-emc" title="">USB C Port with EMC</a></li>
                            <li><a href="ftdi-dev-board.html#ft260s" title="">FTDI FT260S</a></li>
                            <li><a href="ftdi-dev-board.html#ft312d" title="">FTDI FT312D</a></li>
                            <li><a href="ftdi-dev-board.html#esp32-with-auto-reset" title="">ESP32 with Auto Reset</a></li>
                            <li><a href="ftdi-dev-board.html#ic-switch" title="">IC Switch</a></li>
                            <li><a href="ftdi-dev-board.html#bill-of-materials" title="">Bill of Materials</a></li>
                            <li><a href="ftdi-dev-board.html#pcb" title="">PCB</a></li>
                            <li><a href="ftdi-dev-board.html#testing" title="">Testing</a></li>
                          </ul>
                        </li>
                        <li class="has-children"><a href="gps-dev-board.html">GPS Development Board</a>
                          <ul class="sub-menu">
                            <li><a href="gps-dev-board.html" title="">Description</a></li>
                            <li><a href="gps-dev-board.html#schematic" title="">Schematic</a></li>
                            <li><a href="gps-dev-board.html#gps-antenova-m20050" title="">GPS ANTENOVA M20050-1</a></li>
                            <li><a href="gps-dev-board.html#gps-antenova-atgm332d" title="">GPS ATGM332D-5N31</a></li>
                            <li><a href="gps-dev-board.html#battery-holders" title="">Coin Cell Battery Holders</a></li>
                            <li><a href="gps-dev-board.html#bill_of_materials" title="">Bill of Materials</a></li>
                            <li><a href="gps-dev-board.html#pcb" title="">PCB</a></li>
                          </ul>
                        </li>
                        <li class="has-children"><a href="lora-dev-board.html">LoRa Development Board</a>
                          <ul class="sub-menu">
                            <li><a href="lora-dev-board.html" title="">Description</a></li>
                            <li><a href="lora-dev-board.html#schematic" title="">Schematic</a></li>
                            <li><a href="lora-dev-board.html#bill_of_materials" title="">Bill of Materials</a></li>
                            <li><a href="lora-dev-board.html#pcb" title="">PCB</a></li>
                            <li><a href="lora-dev-board.html#firmware-and-testing" title="">Firmware and Testing</a></li>
                          </ul>
                        </li>
                        <li><a href="helios_ren.html">HELIOS REN Tail Light System</a></li>
                        <li class="has-children"><a href="onboardgateway.html">Onboard Gateway</a>
                          <ul class="sub-menu">
                            <li><a href="onboardgateway.html" title="">Description</a></li>
                            <li><a href="onboardgateway.html#main_components" title="">Main Components</a></li>
                            <li><a href="onboardgateway.html#schematic" title="">Schematic</a></li>
                            <li><a href="onboardgateway.html#pcb_layout" title="">Layout</a></li>
                            <li><a href="onboardgateway.html#pcb" title="">PCB</a></li>
                            <li><a href="onboardgateway.html#assembly_guide" title="">Assembly</a></li>
                            <li><a href="onboardgateway.html#wiring_diagrams" title="">Wiring Diagrams</a></li>
                            <li><a href="onboardgateway.html#user_interface" title="">User Interface</a></li>
                            <li><a href="onboardgateway.html#future_improvements" title="">Future Improvements</a></li>
                          </ul>
                        </li>
                        <li class="has-children"><a href="buoya.html">Buoy A</a>
                          <ul class="sub-menu">
                            <li><a href="buoya.html" title="">Description</a></li>
                            <li><a href="buoya.html#main_components" title="">Main Components</a></li>
                            <li><a href="buoya.html#schematic" title="">Schematic</a></li>
                            <li><a href="buoya.html#pcb_layout" title="">Layout</a></li>
                            <li><a href="buoya.html#pcb" title="">PCB</a></li>
                            <li><a href="buoya.html#assembly_guide" title="">Assembly</a></li>
                            <li><a href="buoya.html#wiring_diagrams" title="">Wiring Diagrams</a></li>
                            <li><a href="buoya.html#power-management" title="">Power Management</a></li>
                            <li><a href="buoya.html#servo-motor" title="">Servo Motor</a></li>
                            <li><a href="buoya.html#dc-motor" title="">DC Motor</a></li>
                            <li><a href="buoya.html#future_improvements" title="">Future Improvements</a></li>
                          </ul>
                        </li>
                        <li class="has-children"><a href="buoyb.html">Buoy B</a>
                          <ul class="sub-menu">
                            <li><a href="buoyb.html" title="">Description</a></li>
                            <li><a href="buoyb.html#main_components" title="">Main Components</a></li>
                            <li><a href="buoyb.html#schematic" title="">Schematic</a></li>
                            <li><a href="buoyb.html#pcb_layout" title="">Layout</a></li>
                            <li><a href="buoyb.html#pcb" title="">PCB</a></li>
                            <li><a href="buoyb.html#assembly_guide" title="">Assembly</a></li>
                            <li><a href="buoyb.html#wiring_diagrams" title="">Wiring Diagrams</a></li>
                            <li><a href="buoyb.html#power-management" title="">Power Management</a></li>
                            <li><a href="buoyb.html#servo-motor" title="">Servo Motor</a></li>
                            <li><a href="buoyb.html#stepper-motor" title="">Stepper Motor</a></li>
                            <li><a href="buoyb.html#dc-motor" title="">DC Motor</a></li>
                            <li><a href="buoyb.html#user_interface" title="">User Interface</a></li>
                            <li><a href="buoyb.html#future_improvements" title="">Future Improvements</a></li>
                          </ul>
                        </li>
                    </ul>
                </li>

                <li class="has-children">
                    <a href="embedded-software.html" title="">Embedded Software</a>
                    <ul class="sub-menu">
                        <li class="has-children"><a href="pic-proteus-space-invaders.html">Space Invaders in a 16-Bit PIC</a>
                          <ul class="sub-menu">
                            <li><a href="pic-proteus-space-invaders.html" title="">Description</a></li>
                            <li><a href="pic-proteus-space-invaders.html#getting_started" title="">Getting Started</a></li>
                            <li><a href="pic-proteus-space-invaders.html#design_and_architecture" title="">Design and Architecture</a></li>
                            <li><a href="pic-proteus-space-invaders.html#pic" title="">PIC</a></li>
                            <li><a href="pic-proteus-space-invaders.html#lcd" title="">LCD</a></li>
                            <li><a href="pic-proteus-space-invaders.html#buttons" title="">Buttons</a></li>
                            <li><a href="pic-proteus-space-invaders.html#render" title="">Render</a></li>
                            <li><a href="pic-proteus-space-invaders.html#sprites" title="">Sprites</a></li>
                            <li><a href="pic-proteus-space-invaders.html#animations" title="">Animations</a></li>
                            <li><a href="pic-proteus-space-invaders.html#simulation" title="">Simulation</a></li>
                            <li><a href="pic-proteus-space-invaders.html#future_improvements" title="">Future Improvements</a></li>
                          </ul>
                        </li>
                        <li class="has-children"><a href="gui-onboardgateway.html">GUI for the Onboard Gateway v1.0</a>
                          <ul class="sub-menu">
                            <li><a href="gui-onboardgateway.html" title="">Description</a></li>
                            <li><a href="gui-onboardgateway.html#requirements" title="">Requirements</a></li>
                            <li><a href="gui-onboardgateway.html#async-web-server" title="">Async Web Server</a></li>
                            <li><a href="gui-onboardgateway.html#home" title="">Home</a></li>
                            <li><a href="gui-onboardgateway.html#gps" title="">GPS</a></li>
                            <li><a href="gui-onboardgateway.html#timer" title="">Timer</a></li>
                            <li><a href="gui-onboardgateway.html#lora" title="">Lora</a></li>
                            <li><a href="gui-onboardgateway.html#terminal" title="">Terminal</a></li>
                            <li><a href="gui-onboardgateway.html#led-test" title="">Led Test</a></li>
                            <li><a href="gui-onboardgateway.html#future_improvements" title="">Future Improvements</a></li>
                          </ul>
                        </li>
                        <li class="has-children"><a href="gui-buoyb.html">GUI for Buoy B v1.0</a>
                          <ul class="sub-menu">
                            <li><a href="gui-buoyb.html" title="">Description</a></li>
                            <li><a href="gui-buoyb.html#requirements" title="">Requirements</a></li>
                            <li><a href="gui-buoyb.html#async-web-server" title="">Async Web Server</a></li>
                            <li><a href="gui-buoyb.html#home" title="">Home</a></li>
                            <li><a href="gui-buoyb.html#gps" title="">GPS</a></li>
                            <li><a href="gui-buoyb.html#timer" title="">Timer</a></li>
                            <li><a href="gui-buoyb.html#lora" title="">Lora</a></li>
                            <li><a href="gui-buoyb.html#terminal" title="">Terminal</a></li>
                            <li><a href="gui-buoyb.html#future_improvements" title="">Future Improvements</a></li>
                          </ul>
                        </li>
                    </ul>
                </li>

                <li class="has-children">
                    <a href="robotics.html" title="">Robotics</a>
                    <ul class="sub-menu">
                        <li><a href="sumo.html">Sumo</a></li>
                        <li class="has-children"><a href="#0">Motor Driver Design</a>
                          <ul class="sub-menu">
                            <li><a href="hbridgeboards.html" title="">H-Bridge Designs</a></li>
                            <li><a href="uln2003board.html" title="">ULN2003 Perfboard</a></li>
                            <li><a href="brushlessdc.html" title="">Brushless DC Motor Drivers</a></li>
                          </ul>
                        </li>
                        <li class="has-children"><a href="puma560.html">PUMA 560</a>
                          <ul class="sub-menu">
                            <li><a href="puma560.html#description" title="">Description</a></li>
                            <li><a href="puma560.html#prerequisites" title="">Prerequisites</a></li>
                            <li><a href="puma560.html#robotics-toolbox" title="">Robotics Toolbox</a></li>
                            <li><a href="puma560.html#stl-model" title="">STL Models</a></li>
                            <li><a href="puma560.html#robot-manipulator" title="">RRR Robot Manipulator</a></li>
                            <li><a href="puma560.html#puma-560" title="">PUMA 560 Manipulator</a></li>
                            <li><a href="puma560.html#gui" title="">GUI</a></li>
                          </ul>
                        </li>
                    </ul>
                </li>

                <li class="has-children">
                    <a href="#0" title="">Web Applications</a>
                    <ul class="sub-menu">
                        <li><a href="interactive-map.html">Interactive Map</a></li>
                    </ul>
                </li>

                <li class="has-children">
                    <a href="#0" title="">3D Printing</a>
                    <ul class="sub-menu">
                        <li><a href="3dmap.html">Map</a></li>
                    </ul>
                </li>

                <li class="has-children">
                    <a href="#0" title="">Vehicles</a>
                    <ul class="sub-menu">
                        <li><a href="bajasae.html">Baja SAE USB</a></li>
                    </ul>
                </li>
            </ul> <!-- end header__nav -->

            <a href="#0" title="Close Menu" class="header__overlay-close close-mobile-menu">Close</a>

        </nav> <!-- end header__nav-wrap -->

    </header> <!-- s-header -->


    <!-- s-content
    ================================================== -->
    <section class="s-content s-content--top-padding s-content--narrow">

        <article class="row entry format-standard">

            <div class="entry__media col-full">
                <div class="entry__post-thumb" style="text-align:center">
                    <img src="images/helios_ren/PCB1.jpg" alt="">
                </div>
            </div>

            <div class="entry__header col-full">
                <h1 class="entry__header-title display-1">
                    HELIOS REN Tail Light System
                </h1>
                <ul class="entry__header-meta">
                    <li class="date">February, 2021</li>
                    <li class="byline">
                        By
                        <br>
                        <a href="#0">Carlos Sanoja</a>
                        -
                        <a href="#0">Jesús Guillen</a>
                        -
                        <a href="#0">Leonardo Ward</a>
                        -
                        <a href="#0">Mauricio Marcano</a>
                        -
                        <a href="#0">Oscar Moreno</a>
                        -
                        <a href="#0">Vincenzo D'Argento</a>

                    </li>
                </ul>
            </div>

            <!-- <div class="entry__header col-full">
                <ul class="entry__header-meta">
                  <li class="byline">
                    <h3><a href="https://hackaday.io/project/173457-2020-hdp-dream-team-conservation-x-labs"><img src="images/hackaday.png" width="32" alt=""></a></h3>
                  </li>
                  <li class="byline">
                    <a href="https://hackaday.io/project/173457-2020-hdp-dream-team-conservation-x-labs">Project</a>
                  </li>
                  <li class="byline">
                    <h3><a href="https://github.com/leonardoward/eja-onboard-gateway-electronics"><i class="fab fa-github"></i></a></h3>
                  </li>
                  <li class="byline">
                    <a href="https://github.com/leonardoward/eja-onboard-gateway-electronics">Electronics</a>
                  </li>
                  <li class="byline">
                    <h3><a href="https://github.com/leonardoward/eja-onboard-gateway-firmware"><i class="fab fa-github"></i></a></h3>
                  </li>
                  <li class="byline">
                    <a href="https://github.com/leonardoward/eja-onboard-gateway-firmware">Firmware</a>
                  </li>
                </ul>
            </div> -->

            <div class="col-full entry__main">

                <p class="lead drop-cap">El siguiente trabajo presenta las etapas del diseño de un prototipo de sistema de luces traseras para una bicicleta. Se realiza la selección de los componentes adecuados a los requerimientos del proyecto y a los criterios del equipo de trabajo. Se realiz\'o la simulación del funcionamiento del sistema en el software Proteus, y la codificación con la ayuda de MPLABX. Adicionalmente, se presenta el diseño PCB del circuito y las modificaciones a la propuesta de la competencia.</p>

                <h2 id="requerimientos">Requerimientos</h2>

                <h3>Requerimientos Generales</h2>

                <p>Diseñar un prototipo de un sistema de luces traseras para bicicletas.</p>

                <h3>Requerimientos Específicos</h2>

                <ul>
                  <li>Autonomía de 25 horas en funcionamiento continuo.</li>
                  <li>Uso de baterías recargables, la recarga se realiza utilizando un puerto USB.</li>
                  <li>Tres modos de operación.</li>
                  <li>Valor final viable para el mercado (25€ $<$ valor $<$ 40€)</li>
                  <li>Utilizar componentes disponibles, asequibles y con soporte en el mercado.</li>
                </ul>

                <p>Además, se propone añadir otra versión del producto comercializado en su versión PRO, con los siguientes requerimientos:</p>

                <ul>
                  <li>Luces de cruce para cada lado e intermitentes.</li>
                  <li>Control de mando ajustable al volante del ciclista para controlar el comportamiento del producto.</li>
                </ul>

                <p>La Figura 1 describe los distintos modos de operación propuestos para el sistema de luces traseras. Además, plantea el uso de un único botón para realizar la transición entre modos. Las luces de cruce no se ven reflejadas en los modos de operación, dichas luces solo tienen dos estados: encendido y apagado.</p>

                <div class="col-full" style="text-align:center">
                    <img src="images/helios_ren/D_Estado.jpg" alt="">
                    <p>Figura 1: Diagrama que muestra los modos de uso de las luces traseras</p>
                </div>

                <h2 id="diseno">Diseño</h2>

                <h3>Hardware</h2>

                <p>En la Figura 2 se puede observar el diagrama de bloques de hardware del prototipo. Incluye los componentes esenciales del diseño: pulsadores, baterías, cargador de baterías, luces y los transistores que representan la etapa de control de potencia de cada luz LED. En la Figura 2 se les llama luces de freno a las luces traseras que no se utilizan para indicar cruces.</p>

                <div class="col-full" style="text-align:center">
                    <img src="images/helios_ren/D_Hardware.jpg" alt="">
                    <p>Figura 2: Diagrama de Bloques de Hardware</p>
                </div>

                <h4>Alimentación</h4>

                <p>Para incorporar baterías de litio recargables al diseño se seleccionó un módulo basado en el integrado TP4056, que contiene un cargador de corriente y voltaje constante para baterías de ion litio de una celda (Figura 3). Las baterías de 1 celda tienen un voltaje nominal de 3.7V, dicho valor se establece como el voltaje de alimentación de los circuitos lógicos en el diseño.</p>

                <p>Para dimensionar las baterías se tomó como referencia que el dispositivo debe ser capaz de ofrecer un funcionamiento de 26 horas continuas con ambas luces principales encendidas a máxima potencia. Cada LED presenta un consumo máximo de 180 mA, de manera que: 2x180 mA x 26h = 9360 mAh. En este sentido se decidió usar un arreglo de 4 baterías de 2600 mAh en paralelo, lo que ofrece 10400 mAh que permiten cubrir la demanda de los LEDs previamente descrita.</p>

                <div class="col-full" style="text-align:center">
                    <img src="images/helios_ren/BatC.png" alt="">
                    <p>Figura 3: Módulo TP4056, cargador de Batería.</p>
                </div>

                <h4>Microcontrolador</h4>

                <p>Los requerimientos funcionales del proyecto son:</p>

                <ul>
                  <li>4 salidas digitales para controlar 4 LEDs.</li>
                  <li>Programar el dispositivo vía ICSP.</li>
                  <li>Alimentación con 3.7V.</li>
                  <li>4 entradas digitales para controlar el comportamiento de las luces LEDs.</li>
                </ul>

                <p>Como es posible observar, las principales limitantes para escoger un microprocesador para esta aplicación, son los puertos digitales disponibles en el mismo. Es por ello que se buscó uno con dichas características y que fuese conservador con los recursos internos. Las familias de productos PIC12F y PIC16F tienen un CPU de 8 bits que puede funcionar a velocidades de hasta 5 MIPS (Millions of Instructions Per Second). Las variantes de dispositivos de la familia PIC12F tienen 8 pines, mientras que las variantes PIC16F se ofrecen en paquetes de 14 a 64 pines. Para el proyecto, se escogió el procesador PIC16F1454 de Microchip debido a que es la familia de procesadores mas cercana a cumplir con nuestros requerimientos funcionales.</p>

                <p>La gama PIC16F de microcontroladores de Microchip son MCU de 8 bits que incorporan la arquitectura PIC de Microchip de una gran variedad de opciones de encapsulado y con dispositivos desde 14 contactos. La familia PIC16F1454/1455/1459 de microcontroladores se basa en el núcleo de arquitectura media con 49 instrucciones y proporcionan hasta 12 MIPS, 14 Kbytes de memoria de programa, y memoria de datos de 1024 bytes de RAM. En la placa hay un oscilador configurable con una precisión de ±0,25 %.</p>

                <p>Características del microcontrolador PIC16F1455:</p>

                <ul>
                  <li>Velocidad de CPU máx. de 48 MHz.</li>
                  <li>Bloque de oscilador interno de 16 MHz – Rango de frecuencia seleccionable de 16 MHz a 32 kHz.</li>
                  <li>12 contactos de E/S – PIC16F1454/1455.</li>
                  <li>Programación serie en circuito (ICSP).</li>
                  <li>Dos temporizadores de 8 bits.</li>
                </ul>

                <p>Además, este dispositivo cuenta con otros periféricos como un convertidor analógico a digital (ADC) de 10 bits y 5 canales, puerto serie síncrono maestro (MSSP) con SPI e I2C, sin embargo, los mismos no son utilizados. El Pinout del dispositivo puede ser observado en la figura 4.</p>

                <div class="col-full" style="text-align:center">
                    <img src="images/helios_ren/Pinout.jpg" alt="">
                    <p>Figura 4: Pinout PIC16F1455.</p>
                </div>

                <div class="col-full" style="text-align:center">
                    <img src="images/helios_ren/pic.png" alt="">
                    <p>Figura 5: Símbolo PIC16F1455 en el esquemático.</p>
                </div>

                <p>Se puede programar el microcontrolador utilizando un programador ICSP (se puede utilizar para cualquier chip PIC). Las conexiones ICSP se muestran en el siguiente diagrama (Figura 6):</p>

                <div class="col-full" style="text-align:center">
                    <img src="images/helios_ren/icsp.png" alt="">
                    <p>Figura 6: Símbolo para la entrada ICSP en el esquemático.</p>
                </div>

                <p>Para el presente diseño no se considero necesario el uso de un oscilador externo por dos razones:</p>

                <ul>
                  <li>El microcontrolador cuenta con uno interno de 16MHz configurable con alta precisión.</li>
                  <li>A pesar de existir la probabilidad de errores en la medición de los tiempos, esta no es un aplicación sensible a cambios en milisegundos, ya que los modos de operación de las luces son cuantificados en segundos. Cualquier cambio de comportamiento seria prácticamente imperceptible y no justifica aumentar la complejidad del diseño en hardware.</li>
                  <li>Utilizar un dispositivo externo equivale a utilizar 2 GPIO más para este propósito.</li>
                </ul>

                <h4>Iluminación</h4>

                <p>Se utilizaron cuatro LEDs de 0.5 Watts, dos de ellos para las luces de parada y dos para luces de cruce. Se seleccionó el LED blanco de OVS5MWBCR4 de la marca TT Electronics de 50 lm, cuyo voltaje de fordward está en el rango de [3.0 ; 4.1] V, una corriente nominal de 180 mA y un pico de corriente 350 mA, de esta manera no hace falta resistencia de protección para dichos LEDs, ya que la alimentación es de 3.7V. Para optimizar la distancia de visualización de los LEDs se utilizan lentes de enfoque a 10° de apertura para cada uno.</p>

                <p>Para controlar a los LEDs se necesitó cuatros transistores. Se seleccionó dos integrados BTS3405GXUMA1 de la marca Infineon, cada integrado tiene dos transistores cuyo voltaje drain-source máximo (VDS) es de 42 V, corriente máxima de drain es 350 mA cada uno, ideal para los LEDs escogidos; y voltaje de activación de 1.7V, por lo tanto es compatible con la lógica de 3.3V  del microcontrolador.</p>

                <div class="col-full" style="text-align:center">
                    <img src="images/helios_ren/leds.png" alt="">
                    <p>Figura 7: Sistema de control para las luces LED.</p>
                </div>

                <h4>Interfaz de control</h4>

                <p>El control de las luces cuenta con dos formatos. El primero, cuenta con un solo botón, el mismo es capaz de realizar ciclos de encendido, pasando por los distintos modos de operación, hasta el apagado. Este botón estará en el case del dispositivo.</p>

                <div class="col-full" style="text-align:center">
                    <img src="images/helios_ren/Case2.PNG" alt="">
                    <p>Figura 8: Sistema de control para las luces LED.</p>
                </div>

                <p>El segundo formato, es usando un mando de control. A través de esta opción se podrá incorporar mas funciones, entre ellas, luces intermitentes y luces de cruce, además de los modos de operación que se mantienen igual. Esta versión del producto tiene costo extra y el mismo puede ser observado a continuación.</p>

                <div class="col-full" style="text-align:center">
                    <img src="images/helios_ren/mando.png" alt="">
                    <p>Figura 9: Sistema de control externo para las luces LED.</p>
                </div>

                <h3>Software</h3>

                <p>En la Figura 10 se puede observar el diagrama de bloques del software para el microcontrolador. Cada pulsador se encuentra conectado a un puerto de entrada y salida, configurado como entrada. El microcontrolador debe identificar el estado en el puerto de entrada y manejar los posibles rebotes asociados.</p>

                <p>Un deslizador selecciona la luz de cruce que se va utilizar. Un bot\'on coloca ambas luces de cruce en modo intermitente. Un pulsador cambia el estado de las luces traseras, dichas luces siguen los modos presentados en la Figura 1.</p>

                <p>Dado que no se utilizó ningún periférico, la única configuración realizada al microcontrolador fue la de escoger el oscilador. Como se mencionó anteriormente, se optó por utilizar el oscilador interno del dispositivo, con una frecuencia de 31KHz, la menor posible. Esto debido a que no se necesita un nivel de precisión elevado, además de que permite un menor consumo de las baterías.</p>

                <p>Una vez realizada la selección del hardware, se realizó el Diagrama de Bloques de Software que se muestra en la Figura 10. Dicho diagrama muestra los periféricos utilizados, y los elementos del software indispensables: incluyendo la lectura de los puertos, el manejo de rebotes en el caso de ser necesario y el uso de un controlador que establece las señales para las luces y maneja los puertos de salida conectados a los transistores de potencia. También se realizó un Diagrama Jerárquico de Software, se observa en la Figura 11, que muestra como se relacionan los elementos antes mencionados. Finalmente se realizó el Diagrama de Capas de Software, que se muestra en la Figura 12, dicho diagrama se enfoca en establecer cuáles elementos podrían tener mayor complejidad. En el Diagrama de capas, los bloques considerados con mayor complejidad son los controladores porque deben manejar los estados de cada luz, además el diagrama muestra el amplio uso de los puertos de entrada y salida en el proyecto.</p>

                <p>En las Figuras 10, 11 y 12 se les llama luces de \textit{freno} a las luces traseras que no se utilizan para indicar cruces.</p>

                <h4>Implementación</h4>

                <p>A nivel de código, luego de inicializar el sistema y las variables necesarias, el programa fluye de la siguiente manera:</p>

                <ul>
                  <li>Se realiza la lectura de todas las entradas, es decir, si se han presionado o no alguno de los botones.</li>
                  <li>Se verifica si se ha presionado el botón para encender las luces intermitentes, el cual tiene prioridad sobre cualquier luz de cruce. En caso de que sí, se realiza dicha acción.</li>
                  <li>Si no se presionó el botón para las luces intermitentes, se verifica si se presionó el que enciende la luz de cruce derecha. En caso de que sí, se realiza dicha acción.</li>
                  <li>Si no se presionó el botón para las luces intermitentes, ni el botón para encender la luz de cruce derecha, se verifica si se presionó el que enciende la luz de cruce izquierda. En caso de que sí, se realiza dicha acción.</li>
                  <li>En caso de no haber presionado ninguno de estos tres botones, las luces de cruce simplemente quedan apagadas.</li>
                  <li>Se verifica si se ha presionado el botón para cambiar el modo de operación de las luces de parada. El modo de operación inicia por defecto en 0. Este cambia cuando se detecta un flanco de bajada, es decir, al dejar de presionar el botón. Los modos se operación son los siguientes:
                    <ul>
                      <li>Modo 0: las luces de parada se mantienen apagadas.</li>
                      <li>Modo 1: las luces de parada se mantienen encendidas de manera fija.</li>
                      <li>Modo 2: las luces de parada se encienden de manera intermitente.</li>
                      <li>Modo 3: las luces de parada se mantienen de manera intermitente con los ciclos de encendido y apagado invertidos, es decir, solo se enciende un LED a la vez.</li>
                    </ul>
                  </li>
                  <li>Se aplica el modo de control seleccionado, el cual es manejado por una máquina de estados, mostrado en la Figura 1.</li>
                  <li>Se actualizan todas las variables de control.</li>
                </ul>

                <p>Cabe destacar que los ciclos de encendido y apagado de las luces, al momento de ser necesarios, son temporizados haciendo uso de contadores de ciclo. Para determinar el número de ciclos correcto, de modo que las luces cambiaran de estado en un tiempo prudencial, se realizó un proceso iterativo en el que se hicieron pruebas con distintos valores, hasta determinar el más apropiado.</p>

                <p>Adicionalmente, se cuenta con un control de rebote por software para el caso del botón de selección de modos.</p>

                <div class="col-full" style="text-align:center">
                    <img src="images/helios_ren/D_BloquesSoft.jpg" alt="">
                    <p>Figura 10: Diagrama de Bloques de Software.</p>
                </div>

                <div class="col-full" style="text-align:center">
                    <img src="images/helios_ren/D_jerarquico.jpg" alt="">
                    <p>Figura 11: Diagrama Jerárquico de Software.</p>
                </div>

                <div class="col-full" style="text-align:center">
                    <img src="images/helios_ren/D_jerarquico.jpg" alt="">
                    <p>Figura 11: Diagrama Jerárquico de Software.</p>
                </div>

                <div class="col-full" style="text-align:center">
                    <img src="images/helios_ren/D_decapas.jpg" alt="">
                    <p>Figura 12: Diagrama de Capas de Software</p>
                </div>

                <h2>Resultados</h2>

                <p>Se realizó la simulación del circuito propuesto en Proteus, en la  Figura 13 se puede apreciar el diseño realizado. Los interruptores del mando se modelaron como Switches, mientras que para el control de los distintos modos se incorporó un botón.
                El sistema de alimentación no se ilustra en la simulación, únicamente se incorporan fuentes del voltaje correspondiente. Los integrados seleccionados como transistores (BTS3405GXUMA1) no se pueden simular en Proteus, por lo que se representaron mediante sus equivalentes MOSFET.
                Se lograron simular exitosamente los distintos modos de operación, en el vídeo entregado se muestra su funcionamiento.</p>

                <div class="col-full" style="text-align:center">
                    <img src="images/helios_ren/Simulacion_Proteus.jpg" alt="">
                    <p>Figura 13: Modelo del circuito en Proteus</p>
                </div>

                <p>Se puede concluir que los precios finales de venta se encuentran dentro de los márgenes de los requerimientos y, dependiendo de la configuración y el tamaño de la compra, se obtienen mas beneficios con nuestra solución a un precio competitivo.</p>

                <p>Como paso extra para desarrollar el proyecto, se hizo el diseño del PCB del sistema completo. El mismo fue realizado con el Software Altium Designer y los resultados pueden ser observados a continuación.</p>

                <div class="col-full" style="text-align:center">
                    <img src="images/helios_ren/PCB1.jpg" alt="">
                    <p>Figura 14: PCB del sistema. Vista 1</p>
                </div>

                <div class="col-full" style="text-align:center">
                    <img src="images/helios_ren/PCB2.jpg" alt="">
                    <p>Figura 15: PCB del sistema. Vista 2</p>
                </div>

                <p>Finalmente, a efectos de culminar un prototipo de diseño mecánico, se diseñ\'o una carcasa utilizando el Software de modelado 3D AutoCAD. Los resultados finales pueden ser observados a continuación:</p>

                <div class="col-full" style="text-align:center">
                    <img src="images/helios_ren/Case.PNG" alt="">
                    <p>Figura 16: Carcasa del PCB</p>
                </div>

                <div class="entry__taxonomies">
                    <div class="entry__cat">
                        <h5>Posted In: </h5>
                        <span class="entry__tax-list">
                            <a href="embedded-hardware.html">Embedded Hardware</a>
                        </span>
                    </div> <!-- end entry__cat -->

                    <div class="entry__tags">
                        <h5>Tags: </h5>
                        <span class="entry__tax-list entry__tax-list--pill">
                            <a href="#0">PCB Design</a>
                            <a href="#0">Altium</a>
                            <a href="#0">LED Applications</a>
                            <a href="#0">Proteus</a>
                            <a href="#0">MPLABX</a>
                        </span>
                    </div> <!-- end entry__tags -->
                </div> <!-- end s-content__taxonomies -->

                <!-- <div class="entry__author">
                    <img src="images/avatars/foto.png" alt="">

                    <div class="entry__author-about">
                        <h5 class="entry__author-name">
                            <span>Posted by</span>
                            <a href="#0">Leonardo Ward</a>
                        </h5>

                        <div class="entry__author-desc">
                            <p>
                            MSc. Student in Electronic Engineering at Simón Bolívar University, Venezuela.
                            </p>
                        </div>
                    </div>
                </div> -->

            </div> <!-- s-entry__main -->

        </article> <!-- end entry/article -->


        <div class="s-content__entry-nav">
            <div class="row s-content__nav">
                <div class="col-six s-content__prev">
                    <a href="gui-onboardgateway.html" rel="prev">
                        <span>Previous Post</span>
                        GUI for the Onboard Gateway | Hackaday Dream Team 2020
                    </a>
                </div>
                <div class="col-six s-content__next">
                    <a href="pic-proteus-space-invaders.html" rel="next">
                        <span>Next Post</span>
                        Embedded Software | Space Invaders adaptation for a 16-Bit PIC Microcontroller
                    </a>
                </div>
            </div>
        </div> <!-- end s-content__pagenav -->

    </section> <!-- end s-content -->

    <!-- s-footer
    ================================================== -->
    <footer class="s-footer">

        <div class="s-footer__main">
            <div class="row">
              <div class="col-six tab-full s-footer__about">

                  <h4>Leonardo Ward</h4>

                  <p>New ideas and technologies can create revolutionary products. I am an Engineer in the field of Electronics with experience in research, product development and project management. I am a student of a Master’s degree in Mechatronics with experience in robotics and self-driving (with CARLA and RTMaps) systems including control, sensor fusion, visual perception (with OpenCV), non-linear optimization and statistical estimation.</p>

              </div>
              <div class="col-six tab-full s-footer__about">

                  <p>I have designed and developed applications using object-oriented programming in Python, Java and C++. Also I have experience in front-end, back-end, database and mobile development using HTML, CSS, Javascript, Angular, Vuejs, Quasar, NodeJS and MySQL.</p>

                  <p>I have worked with linux-based systems (like Ubuntu), and version control systems (Github
                  and Bitbucket).</p>

              </div>
            </div>
        </div> <!-- end s-footer__main -->

        <div class="s-footer__bottom">
            <div class="row">

                <div class="col-six">
                    <ul class="footer-social">
                        <li>
                            <a href="https://www.linkedin.com/in/leonardo-ward"><i class="fab fa-linkedin"></i></a>
                        </li>
                        <li>
                            <a href="https://github.com/leonardoward"><i class="fab fa-github"></i></a>
                        </li>
                    </ul>
                </div>

                <div class="col-six">
                    <div class="s-footer__copyright">
                        <span><!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved | This template is made with <i class="fa fa-heart" aria-hidden="true"></i> by <a href="https://colorlib.com" target="_blank">Colorlib</a>
<!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
</span>
                    </div>
                </div>

            </div>
        </div> <!-- end s-footer__bottom -->

        <div class="go-top">
            <a class="smoothscroll" title="Back to Top" href="#top"></a>
        </div>

    </footer> <!-- end s-footer -->


    <!-- Java Script
    ================================================== -->
    <script src="js/jquery-3.2.1.min.js"></script>
    <script src="js/plugins.js"></script>
    <script src="js/main.js"></script>

</body>

</html>
